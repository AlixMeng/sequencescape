<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Class: AssignTagsToWellsTask
  
    &mdash; Documentation by YARD 0.9.5
  
</title>

  <link rel="stylesheet" href="css/style.css" type="text/css" charset="utf-8" />

  <link rel="stylesheet" href="css/common.css" type="text/css" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  pathId = "AssignTagsToWellsTask";
  relpath = '';
</script>


  <script type="text/javascript" charset="utf-8" src="js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="class_list.html"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="_index.html">Index (A)</a> &raquo;
    
    
    <span class="title">AssignTagsToWellsTask</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <iframe id="search_frame" src="class_list.html"></iframe>

      <div id="content"><h1>Class: AssignTagsToWellsTask
  
  
  
</h1>
<div class="box_info">
  
  <dl>
    <dt>Inherits:</dt>
    <dd>
      <span class="inheritName"><span class='object_link'><a href="Task.html" title="Task (class)">Task</a></span></span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next"><span class='object_link'><a href="ActiveRecord/Base.html" title="ActiveRecord::Base (class)">ActiveRecord::Base</a></span></li>
          
            <li class="next"><span class='object_link'><a href="Task.html" title="Task (class)">Task</a></span></li>
          
            <li class="next">AssignTagsToWellsTask</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
    </dd>
  </dl>
  

  
  
  
  
  <dl>
      <dt>Includes:</dt>
      <dd><span class='object_link'><a href="Request/GroupingHelpers.html" title="Request::GroupingHelpers (module)">Request::GroupingHelpers</a></span></dd>
  </dl>
  
  

  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>app/models/assign_tags_to_wells_task.rb</dd>
  </dl>
  
</div>

<h2>Defined Under Namespace</h2>
<p class="children">
  
    
  
    
      <strong class="classes">Classes:</strong> <span class='object_link'><a href="AssignTagsToWellsTask/AssignTagsToWellsData.html" title="AssignTagsToWellsTask::AssignTagsToWellsData (class)">AssignTagsToWellsData</a></span>
    
  
</p>







  
    <h2>
      Instance Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#assign_tags_to_wells-instance_method" title="#assign_tags_to_wells (instance method)">#<strong>assign_tags_to_wells</strong>(requests, well_id_tag_id_map)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#create_render_element-instance_method" title="#create_render_element (instance method)">#<strong>create_render_element</strong>(request)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#create_tag_instances_and_link_to_wells-instance_method" title="#create_tag_instances_and_link_to_wells (instance method)">#<strong>create_tag_instances_and_link_to_wells</strong>(requests, params)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#do_task-instance_method" title="#do_task (instance method)">#<strong>do_task</strong>(workflow, params)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#find_plates_from_batch-instance_method" title="#find_plates_from_batch (instance method)">#<strong>find_plates_from_batch</strong>(batch_id)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#find_sequencing_requests-instance_method" title="#find_sequencing_requests (instance method)">#<strong>find_sequencing_requests</strong>(pulldown_requests)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#link_pulldown_indexed_libraries_to_multiplexed_library-instance_method" title="#link_pulldown_indexed_libraries_to_multiplexed_library (instance method)">#<strong>link_pulldown_indexed_libraries_to_multiplexed_library</strong>(requests)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#map_asset_ids_to_normalised_index_by_submission-instance_method" title="#map_asset_ids_to_normalised_index_by_submission (instance method)">#<strong>map_asset_ids_to_normalised_index_by_submission</strong>(requests)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#map_tags_to_wells-instance_method" title="#map_tags_to_wells (instance method)">#<strong>map_tags_to_wells</strong>(tag_group, plate)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#partial-instance_method" title="#partial (instance method)">#<strong>partial</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#render_task-instance_method" title="#render_task (instance method)">#<strong>render_task</strong>(workflow, params)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#retag_tubes-instance_method" title="#retag_tubes (instance method)">#<strong>retag_tubes</strong>(requests, well_id_tag_id_map)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#tag_tubes-instance_method" title="#tag_tubes (instance method)">#<strong>tag_tubes</strong>(requests, well_id_tag_id_map)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#unlink_tag_instances_from_wells-instance_method" title="#unlink_tag_instances_from_wells (instance method)">#<strong>unlink_tag_instances_from_wells</strong>(requests)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#validate_returned_tags_are_not_repeated_in_submission%21-instance_method" title="#validate_returned_tags_are_not_repeated_in_submission! (instance method)">#<strong>validate_returned_tags_are_not_repeated_in_submission!</strong>(requests, params)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#validate_tags_not_repeated_for_submission%21-instance_method" title="#validate_tags_not_repeated_for_submission! (instance method)">#<strong>validate_tags_not_repeated_for_submission!</strong>(requests, tags_to_wells)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
    </ul>
  


  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="Request/GroupingHelpers.html" title="Request::GroupingHelpers (module)">Request::GroupingHelpers</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="Request/GroupingHelpers.html#group_requests_by_submission_id-instance_method" title="Request::GroupingHelpers#group_requests_by_submission_id (method)">#group_requests_by_submission_id</a></span></p>

  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods inherited from <span class='object_link'><a href="Task.html" title="Task (class)">Task</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="Task.html#find_batch-instance_method" title="Task#find_batch (method)">#find_batch</a></span>, <span class='object_link'><a href="Task.html#find_batch_requests-instance_method" title="Task#find_batch_requests (method)">#find_batch_requests</a></span>, <span class='object_link'><a href="Task.html#generate_events_from_descriptors-instance_method" title="Task#generate_events_from_descriptors (method)">#generate_events_from_descriptors</a></span>, <span class='object_link'><a href="Task.html#get_descriptor_value-instance_method" title="Task#get_descriptor_value (method)">#get_descriptor_value</a></span>, <span class='object_link'><a href="Task.html#get_subclass_attribute_options-class_method" title="Task.get_subclass_attribute_options (method)">get_subclass_attribute_options</a></span>, <span class='object_link'><a href="Task.html#get_subclass_attribute_options-instance_method" title="Task#get_subclass_attribute_options (method)">#get_subclass_attribute_options</a></span>, <span class='object_link'><a href="Task.html#get_subclass_attribute_value-instance_method" title="Task#get_subclass_attribute_value (method)">#get_subclass_attribute_value</a></span>, <span class='object_link'><a href="Task.html#get_subclass_attributes-class_method" title="Task.get_subclass_attributes (method)">get_subclass_attributes</a></span>, <span class='object_link'><a href="Task.html#get_subclass_attributes-instance_method" title="Task#get_subclass_attributes (method)">#get_subclass_attributes</a></span>, <span class='object_link'><a href="Task.html#included_for_do_task-instance_method" title="Task#included_for_do_task (method)">#included_for_do_task</a></span>, <span class='object_link'><a href="Task.html#included_for_render_task-instance_method" title="Task#included_for_render_task (method)">#included_for_render_task</a></span>, <span class='object_link'><a href="Task.html#init_class-class_method" title="Task.init_class (method)">init_class</a></span>, <span class='object_link'><a href="Task.html#set_descriptor_value-instance_method" title="Task#set_descriptor_value (method)">#set_descriptor_value</a></span>, <span class='object_link'><a href="Task.html#set_subclass_attribute-class_method" title="Task.set_subclass_attribute (method)">set_subclass_attribute</a></span>, <span class='object_link'><a href="Task.html#set_subclass_attribute_value-instance_method" title="Task#set_subclass_attribute_value (method)">#set_subclass_attribute_value</a></span>, <span class='object_link'><a href="Task.html#sub_events_for-instance_method" title="Task#sub_events_for (method)">#sub_events_for</a></span>, <span class='object_link'><a href="Task.html#subassets_for_asset-instance_method" title="Task#subassets_for_asset (method)">#subassets_for_asset</a></span></p>

  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods inherited from <span class='object_link'><a href="ActiveRecord/Base.html" title="ActiveRecord::Base (class)">ActiveRecord::Base</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="ActiveRecord/Base.html#find_by_id_or_name-class_method" title="ActiveRecord::Base.find_by_id_or_name (method)">find_by_id_or_name</a></span>, <span class='object_link'><a href="ActiveRecord/Base.html#find_by_id_or_name%21-class_method" title="ActiveRecord::Base.find_by_id_or_name! (method)">find_by_id_or_name!</a></span>, <span class='object_link'><a href="ActiveRecord/Base.html#routing_key-instance_method" title="ActiveRecord::Base#routing_key (method)">#routing_key</a></span>, <span class='object_link'><a href="ActiveRecord/Base.html#transaction_with_amqp-class_method" title="ActiveRecord::Base.transaction_with_amqp (method)">transaction_with_amqp</a></span></p>

  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="ApiTools.html" title="ApiTools (module)">ApiTools</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="ApiTools.html#as_json-instance_method" title="ApiTools#as_json (method)">#as_json</a></span>, <span class='object_link'><a href="ApiTools.html#for_api-instance_method" title="ApiTools#for_api (method)">#for_api</a></span>, <span class='object_link'><a href="ApiTools.html#included-class_method" title="ApiTools.included (method)">included</a></span>, <span class='object_link'><a href="ApiTools.html#list_json-instance_method" title="ApiTools#list_json (method)">#list_json</a></span>, <span class='object_link'><a href="ApiTools.html#to_xml-instance_method" title="ApiTools#to_xml (method)">#to_xml</a></span>, <span class='object_link'><a href="ApiTools.html#to_yaml-instance_method" title="ApiTools#to_yaml (method)">#to_yaml</a></span>, <span class='object_link'><a href="ApiTools.html#url-instance_method" title="ApiTools#url (method)">#url</a></span>, <span class='object_link'><a href="ApiTools.html#url_name-instance_method" title="ApiTools#url_name (method)">#url_name</a></span></p>


  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="assign_tags_to_wells-instance_method">
  
    #<strong>assign_tags_to_wells</strong>(requests, well_id_tag_id_map)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


34
35
36
37
38
39</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/assign_tags_to_wells_task.rb', line 34</span>

<span class='kw'>def</span> <span class='id identifier rubyid_assign_tags_to_wells'>assign_tags_to_wells</span><span class='lparen'>(</span><span class='id identifier rubyid_requests'>requests</span><span class='comma'>,</span> <span class='id identifier rubyid_well_id_tag_id_map'>well_id_tag_id_map</span><span class='rparen'>)</span>
  <span class='comment'># If the tubes have been processed they will have aliquots.  That means that this is a retagging
</span>  <span class='comment'># operation, otherwise we&#39;re initially tagging.
</span>  <span class='id identifier rubyid_have_tagged_tubes_already'>have_tagged_tubes_already</span> <span class='op'>=</span> <span class='id identifier rubyid_requests'>requests</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbol'>:target_asset</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_uniq'>uniq</span><span class='period'>.</span><span class='id identifier rubyid_all?'>all?</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_tube'>tube</span><span class='op'>|</span> <span class='kw'>not</span> <span class='id identifier rubyid_tube'>tube</span><span class='period'>.</span><span class='id identifier rubyid_aliquots'>aliquots</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span> <span class='rbrace'>}</span>
  <span class='id identifier rubyid_have_tagged_tubes_already'>have_tagged_tubes_already</span> <span class='op'>?</span> <span class='id identifier rubyid_retag_tubes'>retag_tubes</span><span class='lparen'>(</span><span class='id identifier rubyid_requests'>requests</span><span class='comma'>,</span> <span class='id identifier rubyid_well_id_tag_id_map'>well_id_tag_id_map</span><span class='rparen'>)</span> <span class='op'>:</span> <span class='id identifier rubyid_tag_tubes'>tag_tubes</span><span class='lparen'>(</span><span class='id identifier rubyid_requests'>requests</span><span class='comma'>,</span> <span class='id identifier rubyid_well_id_tag_id_map'>well_id_tag_id_map</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="create_render_element-instance_method">
  
    #<strong>create_render_element</strong>(request)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


17
18
19</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/assign_tags_to_wells_task.rb', line 17</span>

<span class='kw'>def</span> <span class='id identifier rubyid_create_render_element'>create_render_element</span><span class='lparen'>(</span><span class='id identifier rubyid_request'>request</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_request'>request</span><span class='period'>.</span><span class='id identifier rubyid_asset'>asset</span> <span class='op'>&amp;&amp;</span> <span class='const'>AssignTagsToWellsData</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_request'>request</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="create_tag_instances_and_link_to_wells-instance_method">
  
    #<strong>create_tag_instances_and_link_to_wells</strong>(requests, params)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


157
158
159
160
161
162
163</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/assign_tags_to_wells_task.rb', line 157</span>

<span class='kw'>def</span> <span class='id identifier rubyid_create_tag_instances_and_link_to_wells'>create_tag_instances_and_link_to_wells</span><span class='lparen'>(</span><span class='id identifier rubyid_requests'>requests</span><span class='comma'>,</span> <span class='id identifier rubyid_params'>params</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:tag</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_well_id'>well_id</span><span class='comma'>,</span> <span class='id identifier rubyid_tag_id'>tag_id</span><span class='op'>|</span>
    <span class='const'>ActiveRecord</span><span class='op'>::</span><span class='const'>Base</span><span class='period'>.</span><span class='id identifier rubyid_transaction'>transaction</span> <span class='kw'>do</span>
      <span class='const'>Tag</span><span class='period'>.</span><span class='id identifier rubyid_find'>find</span><span class='lparen'>(</span><span class='id identifier rubyid_tag_id'>tag_id</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_tag!'>tag!</span><span class='lparen'>(</span><span class='const'>Well</span><span class='period'>.</span><span class='id identifier rubyid_find'>find</span><span class='lparen'>(</span><span class='id identifier rubyid_well_id'>well_id</span><span class='rparen'>)</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="do_task-instance_method">
  
    #<strong>do_task</strong>(workflow, params)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


30
31
32</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/assign_tags_to_wells_task.rb', line 30</span>

<span class='kw'>def</span> <span class='id identifier rubyid_do_task'>do_task</span><span class='lparen'>(</span><span class='id identifier rubyid_workflow'>workflow</span><span class='comma'>,</span> <span class='id identifier rubyid_params'>params</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_workflow'>workflow</span><span class='period'>.</span><span class='id identifier rubyid_do_assign_tags_to_wells_task'>do_assign_tags_to_wells_task</span><span class='lparen'>(</span><span class='kw'>self</span><span class='comma'>,</span> <span class='id identifier rubyid_params'>params</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="find_plates_from_batch-instance_method">
  
    #<strong>find_plates_from_batch</strong>(batch_id)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


206
207
208
209
210</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/assign_tags_to_wells_task.rb', line 206</span>

<span class='kw'>def</span> <span class='id identifier rubyid_find_plates_from_batch'>find_plates_from_batch</span><span class='lparen'>(</span><span class='id identifier rubyid_batch_id'>batch_id</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_requests'>requests</span> <span class='op'>=</span> <span class='id identifier rubyid_find_batch_requests'>find_batch_requests</span><span class='lparen'>(</span><span class='id identifier rubyid_batch_id'>batch_id</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_plates'>plates</span> <span class='op'>=</span> <span class='id identifier rubyid_requests'>requests</span><span class='period'>.</span><span class='id identifier rubyid_select'>select</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_request'>request</span><span class='op'>|</span> <span class='id identifier rubyid_request'>request</span><span class='period'>.</span><span class='id identifier rubyid_asset'>asset</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'>Well</span><span class='rparen'>)</span> <span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_request'>request</span><span class='op'>|</span> <span class='id identifier rubyid_request'>request</span><span class='period'>.</span><span class='id identifier rubyid_asset'>asset</span> <span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_asset'>asset</span><span class='op'>|</span> <span class='id identifier rubyid_asset'>asset</span><span class='period'>.</span><span class='id identifier rubyid_plate'>plate</span> <span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_select'>select</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_plate'>plate</span><span class='op'>|</span> <span class='id identifier rubyid_plate'>plate</span> <span class='rbrace'>}</span>
  <span class='id identifier rubyid_plates'>plates</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="find_sequencing_requests-instance_method">
  
    #<strong>find_sequencing_requests</strong>(pulldown_requests)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


165
166
167</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/assign_tags_to_wells_task.rb', line 165</span>

<span class='kw'>def</span> <span class='id identifier rubyid_find_sequencing_requests'>find_sequencing_requests</span><span class='lparen'>(</span><span class='id identifier rubyid_pulldown_requests'>pulldown_requests</span><span class='rparen'>)</span>
  <span class='const'>Request</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='label'>submission_id:</span> <span class='id identifier rubyid_pulldown_requests'>pulldown_requests</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span><span class='period'>.</span><span class='id identifier rubyid_submission_id'>submission_id</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_select'>select</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_sequencing_request'>sequencing_request</span><span class='op'>|</span> <span class='id identifier rubyid_sequencing_request'>sequencing_request</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'>SequencingRequest</span><span class='rparen'>)</span> <span class='rbrace'>}</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="link_pulldown_indexed_libraries_to_multiplexed_library-instance_method">
  
    #<strong>link_pulldown_indexed_libraries_to_multiplexed_library</strong>(requests)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


169
170
171
172
173
174
175
176
177
178</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/assign_tags_to_wells_task.rb', line 169</span>

<span class='kw'>def</span> <span class='id identifier rubyid_link_pulldown_indexed_libraries_to_multiplexed_library'>link_pulldown_indexed_libraries_to_multiplexed_library</span><span class='lparen'>(</span><span class='id identifier rubyid_requests'>requests</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_group_requests_by_submission_id'>group_requests_by_submission_id</span><span class='lparen'>(</span><span class='id identifier rubyid_requests'>requests</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_requests_with_same_submission'>requests_with_same_submission</span><span class='op'>|</span>
    <span class='id identifier rubyid_sequencing_requests'>sequencing_requests</span> <span class='op'>=</span> <span class='id identifier rubyid_find_sequencing_requests'>find_sequencing_requests</span><span class='lparen'>(</span><span class='id identifier rubyid_requests_with_same_submission'>requests_with_same_submission</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Couldnt find sequencing request</span><span class='tstring_end'>&#39;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_sequencing_requests'>sequencing_requests</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>

    <span class='comment'># If the requests don&#39;t all end in the same tube!
</span>    <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Borked!</span><span class='tstring_end'>&#39;</span></span> <span class='kw'>unless</span> <span class='id identifier rubyid_requests_with_same_submission'>requests_with_same_submission</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbol'>:target_asset</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_compact'>compact</span><span class='period'>.</span><span class='id identifier rubyid_uniq'>uniq</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span> <span class='op'>==</span> <span class='int'>1</span>
    <span class='id identifier rubyid_sequencing_requests'>sequencing_requests</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_sequencing_request'>sequencing_request</span><span class='op'>|</span> <span class='id identifier rubyid_sequencing_request'>sequencing_request</span><span class='period'>.</span><span class='id identifier rubyid_update_attributes!'>update_attributes!</span><span class='lparen'>(</span><span class='label'>asset:</span> <span class='id identifier rubyid_requests_with_same_submission'>requests_with_same_submission</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span><span class='period'>.</span><span class='id identifier rubyid_target_asset'>target_asset</span><span class='rparen'>)</span> <span class='rbrace'>}</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="map_asset_ids_to_normalised_index_by_submission-instance_method">
  
    #<strong>map_asset_ids_to_normalised_index_by_submission</strong>(requests)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


212
213
214
215
216
217
218
219</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/assign_tags_to_wells_task.rb', line 212</span>

<span class='kw'>def</span> <span class='id identifier rubyid_map_asset_ids_to_normalised_index_by_submission'>map_asset_ids_to_normalised_index_by_submission</span><span class='lparen'>(</span><span class='id identifier rubyid_requests'>requests</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_submissions_to_index'>submissions_to_index</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
  <span class='id identifier rubyid_asset_ids_to_index'>asset_ids_to_index</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
  <span class='id identifier rubyid_requests'>requests</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_request'>request</span><span class='op'>|</span> <span class='id identifier rubyid_request'>request</span><span class='period'>.</span><span class='id identifier rubyid_submission_id'>submission_id</span> <span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_uniq'>uniq</span><span class='period'>.</span><span class='id identifier rubyid_each_with_index'>each_with_index</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_submission_id'>submission_id</span><span class='comma'>,</span> <span class='id identifier rubyid_index'>index</span><span class='op'>|</span> <span class='id identifier rubyid_submissions_to_index'>submissions_to_index</span><span class='lbracket'>[</span><span class='id identifier rubyid_submission_id'>submission_id</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_index'>index</span> <span class='rbrace'>}</span>
  <span class='id identifier rubyid_requests'>requests</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_request'>request</span><span class='op'>|</span> <span class='id identifier rubyid_asset_ids_to_index'>asset_ids_to_index</span><span class='lbracket'>[</span><span class='id identifier rubyid_request'>request</span><span class='period'>.</span><span class='id identifier rubyid_asset_id'>asset_id</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_submissions_to_index'>submissions_to_index</span><span class='lbracket'>[</span><span class='id identifier rubyid_request'>request</span><span class='period'>.</span><span class='id identifier rubyid_submission_id'>submission_id</span><span class='rbracket'>]</span> <span class='rbrace'>}</span>

  <span class='id identifier rubyid_asset_ids_to_index'>asset_ids_to_index</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="map_tags_to_wells-instance_method">
  
    #<strong>map_tags_to_wells</strong>(tag_group, plate)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


193
194
195
196
197
198
199
200
201
202
203
204</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/assign_tags_to_wells_task.rb', line 193</span>

<span class='kw'>def</span> <span class='id identifier rubyid_map_tags_to_wells'>map_tags_to_wells</span><span class='lparen'>(</span><span class='id identifier rubyid_tag_group'>tag_group</span><span class='comma'>,</span> <span class='id identifier rubyid_plate'>plate</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_tags_to_wells'>tags_to_wells</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
  <span class='id identifier rubyid_wells'>wells</span> <span class='op'>=</span> <span class='id identifier rubyid_plate'>plate</span><span class='period'>.</span><span class='id identifier rubyid_wells_sorted_by_map_id'>wells_sorted_by_map_id</span>
  <span class='id identifier rubyid_sorted_tags'>sorted_tags</span> <span class='op'>=</span> <span class='id identifier rubyid_tag_group'>tag_group</span><span class='period'>.</span><span class='id identifier rubyid_tags_sorted_by_map_id'>tags_sorted_by_map_id</span>
  <span class='id identifier rubyid_current_well'>current_well</span> <span class='op'>=</span> <span class='id identifier rubyid_wells'>wells</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>

  <span class='int'>1</span><span class='period'>.</span><span class='id identifier rubyid_upto'>upto</span><span class='lparen'>(</span><span class='id identifier rubyid_plate'>plate</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_index'>index</span><span class='op'>|</span>
    <span class='id identifier rubyid_tags_to_wells'>tags_to_wells</span><span class='lbracket'>[</span><span class='const'>Map</span><span class='op'>::</span><span class='const'>Coordinate</span><span class='period'>.</span><span class='id identifier rubyid_vertical_plate_position_to_description'>vertical_plate_position_to_description</span><span class='lparen'>(</span><span class='id identifier rubyid_index'>index</span><span class='comma'>,</span> <span class='id identifier rubyid_plate'>plate</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span><span class='rparen'>)</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_sorted_tags'>sorted_tags</span><span class='lbracket'>[</span><span class='lparen'>(</span><span class='id identifier rubyid_index'>index</span> <span class='op'>-</span> <span class='int'>1</span><span class='rparen'>)</span> <span class='op'>%</span> <span class='id identifier rubyid_sorted_tags'>sorted_tags</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span><span class='rbracket'>]</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_tags_to_wells'>tags_to_wells</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="partial-instance_method">
  
    #<strong>partial</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


21
22
23</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/assign_tags_to_wells_task.rb', line 21</span>

<span class='kw'>def</span> <span class='id identifier rubyid_partial'>partial</span>
  <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>assign_tags_to_wells_batches</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="render_task-instance_method">
  
    #<strong>render_task</strong>(workflow, params)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


25
26
27
28</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/assign_tags_to_wells_task.rb', line 25</span>

<span class='kw'>def</span> <span class='id identifier rubyid_render_task'>render_task</span><span class='lparen'>(</span><span class='id identifier rubyid_workflow'>workflow</span><span class='comma'>,</span> <span class='id identifier rubyid_params'>params</span><span class='rparen'>)</span>
  <span class='kw'>super</span>
  <span class='id identifier rubyid_workflow'>workflow</span><span class='period'>.</span><span class='id identifier rubyid_render_assign_tags_to_wells_task'>render_assign_tags_to_wells_task</span><span class='lparen'>(</span><span class='kw'>self</span><span class='comma'>,</span> <span class='id identifier rubyid_params'>params</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="retag_tubes-instance_method">
  
    #<strong>retag_tubes</strong>(requests, well_id_tag_id_map)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/assign_tags_to_wells_task.rb', line 41</span>

<span class='kw'>def</span> <span class='id identifier rubyid_retag_tubes'>retag_tubes</span><span class='lparen'>(</span><span class='id identifier rubyid_requests'>requests</span><span class='comma'>,</span> <span class='id identifier rubyid_well_id_tag_id_map'>well_id_tag_id_map</span><span class='rparen'>)</span>
  <span class='comment'># The first thing we do is build a graph of the transfers that have been made so that we can
</span>  <span class='comment'># clean it out.  The assets themselves cannot be rebuilt as people may be relying on the assets
</span>  <span class='comment'># remaining consistent.
</span>  <span class='id identifier rubyid_source_well_to_intermediate_wells'>source_well_to_intermediate_wells</span><span class='comma'>,</span> <span class='id identifier rubyid_requests_to_destroy'>requests_to_destroy</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span><span class='comma'>,</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_requests'>requests</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_request'>request</span><span class='op'>|</span>
    <span class='id identifier rubyid_source_well'>source_well</span><span class='comma'>,</span> <span class='id identifier rubyid_target_tube'>target_tube</span> <span class='op'>=</span> <span class='id identifier rubyid_request'>request</span><span class='period'>.</span><span class='id identifier rubyid_asset'>asset</span><span class='comma'>,</span> <span class='id identifier rubyid_request'>request</span><span class='period'>.</span><span class='id identifier rubyid_target_asset'>target_asset</span>

    <span class='id identifier rubyid_source_to_library'>source_to_library</span> <span class='op'>=</span> <span class='id identifier rubyid_source_well'>source_well</span><span class='period'>.</span><span class='id identifier rubyid_requests_as_source'>requests_as_source</span><span class='period'>.</span><span class='id identifier rubyid_where_is_a?'>where_is_a?</span><span class='lparen'>(</span><span class='const'>TransferRequest</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>
    <span class='id identifier rubyid_library_well'>library_well</span>      <span class='op'>=</span> <span class='id identifier rubyid_source_to_library'>source_to_library</span><span class='period'>.</span><span class='id identifier rubyid_target_asset'>target_asset</span>

    <span class='id identifier rubyid_library_to_tagged'>library_to_tagged</span> <span class='op'>=</span> <span class='id identifier rubyid_library_well'>library_well</span><span class='period'>.</span><span class='id identifier rubyid_requests_as_source'>requests_as_source</span><span class='period'>.</span><span class='id identifier rubyid_where_is_a?'>where_is_a?</span><span class='lparen'>(</span><span class='const'>TransferRequest</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>
    <span class='id identifier rubyid_tagged_well'>tagged_well</span>       <span class='op'>=</span> <span class='id identifier rubyid_library_to_tagged'>library_to_tagged</span><span class='period'>.</span><span class='id identifier rubyid_target_asset'>target_asset</span>

    <span class='id identifier rubyid_tagged_to_pooled'>tagged_to_pooled</span>  <span class='op'>=</span> <span class='id identifier rubyid_tagged_well'>tagged_well</span><span class='period'>.</span><span class='id identifier rubyid_requests_as_source'>requests_as_source</span><span class='period'>.</span><span class='id identifier rubyid_where_is_a?'>where_is_a?</span><span class='lparen'>(</span><span class='const'>TransferRequest</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>
    <span class='id identifier rubyid_pooled_well'>pooled_well</span>       <span class='op'>=</span> <span class='id identifier rubyid_tagged_to_pooled'>tagged_to_pooled</span><span class='period'>.</span><span class='id identifier rubyid_target_asset'>target_asset</span>

    <span class='id identifier rubyid_requests_to_destroy'>requests_to_destroy</span><span class='period'>.</span><span class='id identifier rubyid_concat'>concat</span><span class='lparen'>(</span><span class='lbracket'>[</span><span class='id identifier rubyid_source_to_library'>source_to_library</span><span class='comma'>,</span> <span class='id identifier rubyid_library_to_tagged'>library_to_tagged</span><span class='comma'>,</span> <span class='id identifier rubyid_tagged_to_pooled'>tagged_to_pooled</span><span class='rbracket'>]</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_requests_to_destroy'>requests_to_destroy</span><span class='period'>.</span><span class='id identifier rubyid_concat'>concat</span><span class='lparen'>(</span><span class='id identifier rubyid_pooled_well'>pooled_well</span><span class='period'>.</span><span class='id identifier rubyid_requests_as_source'>requests_as_source</span><span class='period'>.</span><span class='id identifier rubyid_where_is_a?'>where_is_a?</span><span class='lparen'>(</span><span class='const'>TransferRequest</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_all'>all</span><span class='rparen'>)</span>

    <span class='id identifier rubyid_source_well_to_intermediate_wells'>source_well_to_intermediate_wells</span><span class='lbracket'>[</span><span class='id identifier rubyid_source_well'>source_well</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='id identifier rubyid_library_well'>library_well</span><span class='comma'>,</span> <span class='id identifier rubyid_tagged_well'>tagged_well</span><span class='comma'>,</span> <span class='id identifier rubyid_pooled_well'>pooled_well</span><span class='comma'>,</span> <span class='id identifier rubyid_target_tube'>target_tube</span><span class='rbracket'>]</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_requests_to_destroy'>requests_to_destroy</span><span class='period'>.</span><span class='id identifier rubyid_uniq'>uniq</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbol'>:destroy</span><span class='rparen'>)</span>

  <span class='comment'># Now we can clean out the aliquots of all of the various assets and rebuild the graph so that the
</span>  <span class='comment'># correct tags are in place.
</span>  <span class='id identifier rubyid_pooled_well_to_tube'>pooled_well_to_tube</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
  <span class='id identifier rubyid_source_well_to_intermediate_wells'>source_well_to_intermediate_wells</span><span class='period'>.</span><span class='id identifier rubyid_values'>values</span><span class='period'>.</span><span class='id identifier rubyid_flatten'>flatten</span><span class='period'>.</span><span class='id identifier rubyid_uniq'>uniq</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_well'>well</span><span class='op'>|</span> <span class='id identifier rubyid_well'>well</span><span class='period'>.</span><span class='id identifier rubyid_aliquots'>aliquots</span><span class='period'>.</span><span class='id identifier rubyid_clear'>clear</span> <span class='rbrace'>}</span>
  <span class='id identifier rubyid_source_well_to_intermediate_wells'>source_well_to_intermediate_wells</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_source_well'>source_well</span><span class='comma'>,</span> <span class='id identifier rubyid_assets'>assets</span><span class='op'>|</span>
    <span class='id identifier rubyid_library_well'>library_well</span><span class='comma'>,</span> <span class='id identifier rubyid_tagged_well'>tagged_well</span><span class='comma'>,</span> <span class='id identifier rubyid_pooled_well'>pooled_well</span><span class='comma'>,</span> <span class='id identifier rubyid_tube'>tube</span> <span class='op'>=</span> <span class='id identifier rubyid_assets'>assets</span>

    <span class='const'>RequestType</span><span class='period'>.</span><span class='id identifier rubyid_transfer'>transfer</span><span class='period'>.</span><span class='id identifier rubyid_create!'>create!</span><span class='lparen'>(</span><span class='label'>asset:</span> <span class='id identifier rubyid_source_well'>source_well</span><span class='comma'>,</span>  <span class='label'>target_asset:</span> <span class='id identifier rubyid_library_well'>library_well</span><span class='comma'>,</span> <span class='label'>state:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>passed</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
    <span class='id identifier rubyid_library_well'>library_well</span><span class='period'>.</span><span class='id identifier rubyid_aliquots'>aliquots</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_aliquot'>aliquot</span><span class='op'>|</span> <span class='id identifier rubyid_aliquot'>aliquot</span><span class='period'>.</span><span class='id identifier rubyid_update_attributes!'>update_attributes!</span><span class='lparen'>(</span><span class='label'>library:</span> <span class='id identifier rubyid_library_well'>library_well</span><span class='rparen'>)</span> <span class='rbrace'>}</span>

    <span class='const'>RequestType</span><span class='period'>.</span><span class='id identifier rubyid_transfer'>transfer</span><span class='period'>.</span><span class='id identifier rubyid_create!'>create!</span><span class='lparen'>(</span><span class='label'>asset:</span> <span class='id identifier rubyid_library_well'>library_well</span><span class='comma'>,</span> <span class='label'>target_asset:</span> <span class='id identifier rubyid_tagged_well'>tagged_well</span><span class='comma'>,</span>  <span class='label'>state:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>passed</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
    <span class='id identifier rubyid_tag_id'>tag_id</span> <span class='op'>=</span> <span class='id identifier rubyid_well_id_tag_id_map'>well_id_tag_id_map</span><span class='lbracket'>[</span><span class='id identifier rubyid_source_well'>source_well</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span><span class='rbracket'>]</span>
    <span class='const'>Tag</span><span class='period'>.</span><span class='id identifier rubyid_find'>find</span><span class='lparen'>(</span><span class='id identifier rubyid_tag_id'>tag_id</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_tag!'>tag!</span><span class='lparen'>(</span><span class='id identifier rubyid_tagged_well'>tagged_well</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_tag_id'>tag_id</span><span class='period'>.</span><span class='id identifier rubyid_present?'>present?</span>

    <span class='const'>RequestType</span><span class='period'>.</span><span class='id identifier rubyid_transfer'>transfer</span><span class='period'>.</span><span class='id identifier rubyid_create!'>create!</span><span class='lparen'>(</span><span class='label'>asset:</span> <span class='id identifier rubyid_tagged_well'>tagged_well</span><span class='comma'>,</span>  <span class='label'>target_asset:</span> <span class='id identifier rubyid_pooled_well'>pooled_well</span><span class='comma'>,</span>  <span class='label'>state:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>passed</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>

    <span class='id identifier rubyid_raise'>raise</span> <span class='const'>StandardError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Pooled well into different tube!</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>unless</span> <span class='id identifier rubyid_tube'>tube</span> <span class='op'>==</span> <span class='lparen'>(</span><span class='id identifier rubyid_pooled_well_to_tube'>pooled_well_to_tube</span><span class='lbracket'>[</span><span class='id identifier rubyid_pooled_well'>pooled_well</span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='id identifier rubyid_tube'>tube</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_pooled_well_to_tube'>pooled_well_to_tube</span><span class='lbracket'>[</span><span class='id identifier rubyid_pooled_well'>pooled_well</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_tube'>tube</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_pooled_well_to_tube'>pooled_well_to_tube</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_well'>well</span><span class='comma'>,</span> <span class='id identifier rubyid_tube'>tube</span><span class='op'>|</span> <span class='const'>RequestType</span><span class='period'>.</span><span class='id identifier rubyid_transfer'>transfer</span><span class='period'>.</span><span class='id identifier rubyid_create!'>create!</span><span class='lparen'>(</span><span class='label'>asset:</span> <span class='id identifier rubyid_well'>well</span><span class='comma'>,</span> <span class='label'>target_asset:</span> <span class='id identifier rubyid_tube'>tube</span><span class='rparen'>)</span> <span class='rbrace'>}</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="tag_tubes-instance_method">
  
    #<strong>tag_tubes</strong>(requests, well_id_tag_id_map)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  
<p class="tag_title">Raises:</p>
<ul class="raise">
  
    <li>
      
      
        <span class='type'>(<tt>StandardError</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/assign_tags_to_wells_task.rb', line 89</span>

<span class='kw'>def</span> <span class='id identifier rubyid_tag_tubes'>tag_tubes</span><span class='lparen'>(</span><span class='id identifier rubyid_requests'>requests</span><span class='comma'>,</span> <span class='id identifier rubyid_well_id_tag_id_map'>well_id_tag_id_map</span><span class='rparen'>)</span>
  <span class='comment'># to  be compliant with the new pulldown application we have to create intermediate plate and wells
</span>  <span class='id identifier rubyid_source_plates'>source_plates</span> <span class='op'>=</span> <span class='id identifier rubyid_requests'>requests</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbol'>:asset</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbol'>:plate</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_uniq'>uniq</span>
  <span class='id identifier rubyid_raise'>raise</span> <span class='const'>StandardError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Can only tag based on one source plate</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>unless</span> <span class='id identifier rubyid_source_plates'>source_plates</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span> <span class='op'>==</span> <span class='int'>1</span>
  <span class='id identifier rubyid_source_plate'>source_plate</span> <span class='op'>=</span> <span class='id identifier rubyid_source_plates'>source_plates</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>

  <span class='id identifier rubyid_well_to_tagged'>well_to_tagged</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
  <span class='id identifier rubyid_tube_to_pool'>tube_to_pool</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>

  <span class='id identifier rubyid_pooled_plate'>pooled_plate</span>  <span class='op'>=</span> <span class='const'>Plate</span><span class='period'>.</span><span class='id identifier rubyid_create!'>create!</span><span class='lparen'>(</span><span class='label'>size:</span> <span class='id identifier rubyid_source_plate'>source_plate</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_library_plate'>library_plate</span> <span class='op'>=</span> <span class='const'>Plate</span><span class='period'>.</span><span class='id identifier rubyid_create!'>create!</span><span class='lparen'>(</span><span class='label'>size:</span> <span class='id identifier rubyid_source_plate'>source_plate</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_tag_plate'>tag_plate</span>     <span class='op'>=</span> <span class='const'>Plate</span><span class='period'>.</span><span class='id identifier rubyid_create!'>create!</span><span class='lparen'>(</span><span class='label'>size:</span> <span class='id identifier rubyid_source_plate'>source_plate</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_source_plate'>source_plate</span><span class='period'>.</span><span class='id identifier rubyid_wells'>wells</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_well'>well</span><span class='op'>|</span>
    <span class='id identifier rubyid_library_well'>library_well</span> <span class='op'>=</span> <span class='const'>Well</span><span class='period'>.</span><span class='id identifier rubyid_create!'>create!</span>
    <span class='const'>RequestType</span><span class='period'>.</span><span class='id identifier rubyid_transfer'>transfer</span><span class='period'>.</span><span class='id identifier rubyid_create!'>create!</span><span class='lparen'>(</span><span class='label'>asset:</span> <span class='id identifier rubyid_well'>well</span><span class='comma'>,</span> <span class='label'>target_asset:</span> <span class='id identifier rubyid_library_well'>library_well</span><span class='comma'>,</span> <span class='label'>state:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>passed</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
    <span class='id identifier rubyid_library_plate'>library_plate</span><span class='period'>.</span><span class='id identifier rubyid_add_well_by_map_description'>add_well_by_map_description</span><span class='lparen'>(</span><span class='id identifier rubyid_library_well'>library_well</span><span class='comma'>,</span> <span class='id identifier rubyid_well'>well</span><span class='period'>.</span><span class='id identifier rubyid_map_description'>map_description</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_library_well'>library_well</span><span class='period'>.</span><span class='id identifier rubyid_aliquots'>aliquots</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_aliquot'>aliquot</span><span class='op'>|</span> <span class='id identifier rubyid_aliquot'>aliquot</span><span class='period'>.</span><span class='id identifier rubyid_update_attributes!'>update_attributes!</span><span class='lparen'>(</span><span class='label'>library:</span> <span class='id identifier rubyid_library_well'>library_well</span><span class='rparen'>)</span> <span class='rbrace'>}</span>

    <span class='id identifier rubyid_tagged_well'>tagged_well</span> <span class='op'>=</span> <span class='const'>Well</span><span class='period'>.</span><span class='id identifier rubyid_create!'>create!</span>
    <span class='id identifier rubyid_well_to_tagged'>well_to_tagged</span><span class='lbracket'>[</span><span class='id identifier rubyid_well'>well</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_tagged_well'>tagged_well</span>
    <span class='const'>RequestType</span><span class='period'>.</span><span class='id identifier rubyid_transfer'>transfer</span><span class='period'>.</span><span class='id identifier rubyid_create!'>create!</span><span class='lparen'>(</span><span class='label'>asset:</span> <span class='id identifier rubyid_library_well'>library_well</span><span class='comma'>,</span> <span class='label'>target_asset:</span> <span class='id identifier rubyid_tagged_well'>tagged_well</span><span class='comma'>,</span> <span class='label'>state:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>passed</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
    <span class='id identifier rubyid_tag_plate'>tag_plate</span><span class='period'>.</span><span class='id identifier rubyid_add_well_by_map_description'>add_well_by_map_description</span><span class='lparen'>(</span><span class='id identifier rubyid_tagged_well'>tagged_well</span><span class='comma'>,</span> <span class='id identifier rubyid_well'>well</span><span class='period'>.</span><span class='id identifier rubyid_map_description'>map_description</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_tag_id'>tag_id</span> <span class='op'>=</span> <span class='id identifier rubyid_well_id_tag_id_map'>well_id_tag_id_map</span><span class='lbracket'>[</span><span class='id identifier rubyid_well'>well</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span><span class='rbracket'>]</span>
    <span class='const'>Tag</span><span class='period'>.</span><span class='id identifier rubyid_find'>find</span><span class='lparen'>(</span><span class='id identifier rubyid_tag_id'>tag_id</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_tag!'>tag!</span><span class='lparen'>(</span><span class='id identifier rubyid_tagged_well'>tagged_well</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_tag_id'>tag_id</span>
  <span class='kw'>end</span>
  <span class='lbracket'>[</span><span class='id identifier rubyid_library_plate'>library_plate</span><span class='comma'>,</span> <span class='id identifier rubyid_tag_plate'>tag_plate</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbol'>:save!</span><span class='rparen'>)</span>

  <span class='comment'># We could be retagging because someone has changed their minds.
</span>  <span class='id identifier rubyid_requests'>requests</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_request'>request</span><span class='op'>|</span> <span class='id identifier rubyid_request'>request</span><span class='period'>.</span><span class='id identifier rubyid_target_asset'>target_asset</span><span class='period'>.</span><span class='id identifier rubyid_aliquots'>aliquots</span><span class='period'>.</span><span class='id identifier rubyid_clear'>clear</span> <span class='rbrace'>}</span>

  <span class='id identifier rubyid_requests'>requests</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_r'>r</span><span class='op'>|</span>
    <span class='id identifier rubyid_tagged_well'>tagged_well</span> <span class='op'>=</span> <span class='id identifier rubyid_well_to_tagged'>well_to_tagged</span><span class='lbracket'>[</span><span class='id identifier rubyid_r'>r</span><span class='period'>.</span><span class='id identifier rubyid_asset'>asset</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Well not tagged</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_tagged_well'>tagged_well</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
    <span class='id identifier rubyid_tube'>tube</span> <span class='op'>=</span> <span class='id identifier rubyid_r'>r</span><span class='period'>.</span><span class='id identifier rubyid_target_asset'>target_asset</span>

    <span class='id identifier rubyid_pooled_well'>pooled_well</span> <span class='op'>=</span> <span class='id identifier rubyid_tube_to_pool'>tube_to_pool</span><span class='lbracket'>[</span><span class='id identifier rubyid_tube'>tube</span><span class='rbracket'>]</span>
    <span class='kw'>unless</span> <span class='id identifier rubyid_pooled_well'>pooled_well</span>
      <span class='id identifier rubyid_pooled_well'>pooled_well</span> <span class='op'>=</span> <span class='const'>Well</span><span class='period'>.</span><span class='id identifier rubyid_create!'>create!</span>
      <span class='id identifier rubyid_tube_to_pool'>tube_to_pool</span><span class='lbracket'>[</span><span class='id identifier rubyid_tube'>tube</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_pooled_well'>pooled_well</span>
      <span class='id identifier rubyid_pooled_plate'>pooled_plate</span><span class='period'>.</span><span class='id identifier rubyid_add_well_by_map_description'>add_well_by_map_description</span><span class='lparen'>(</span><span class='id identifier rubyid_pooled_well'>pooled_well</span><span class='comma'>,</span> <span class='id identifier rubyid_tagged_well'>tagged_well</span><span class='period'>.</span><span class='id identifier rubyid_map_description'>map_description</span><span class='rparen'>)</span>
    <span class='kw'>end</span>

    <span class='const'>RequestType</span><span class='period'>.</span><span class='id identifier rubyid_transfer'>transfer</span><span class='period'>.</span><span class='id identifier rubyid_create!'>create!</span><span class='lparen'>(</span><span class='label'>asset:</span> <span class='id identifier rubyid_tagged_well'>tagged_well</span><span class='comma'>,</span> <span class='label'>target_asset:</span> <span class='id identifier rubyid_pooled_well'>pooled_well</span><span class='comma'>,</span> <span class='label'>state:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>passed</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
    <span class='comment'># transfer between pooled_well and tube needs to be at the end, when all the aliquots are present
</span>    <span class='comment'># RequestType.transfer.create!(:asset =&gt; pooled_well, :target_asset =&gt; tube)
</span>  <span class='kw'>end</span>

  <span class='id identifier rubyid_tube_to_pool'>tube_to_pool</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_tube'>tube</span><span class='comma'>,</span> <span class='id identifier rubyid_pooled_well'>pooled_well</span><span class='op'>|</span>
    <span class='const'>RequestType</span><span class='period'>.</span><span class='id identifier rubyid_transfer'>transfer</span><span class='period'>.</span><span class='id identifier rubyid_create!'>create!</span><span class='lparen'>(</span><span class='label'>asset:</span> <span class='id identifier rubyid_pooled_well'>pooled_well</span><span class='comma'>,</span> <span class='label'>target_asset:</span> <span class='id identifier rubyid_tube'>tube</span><span class='comma'>,</span> <span class='label'>state:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>passed</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_link_pulldown_indexed_libraries_to_multiplexed_library'>link_pulldown_indexed_libraries_to_multiplexed_library</span><span class='lparen'>(</span><span class='id identifier rubyid_requests'>requests</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="unlink_tag_instances_from_wells-instance_method">
  
    #<strong>unlink_tag_instances_from_wells</strong>(requests)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


187
188
189
190
191</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/assign_tags_to_wells_task.rb', line 187</span>

<span class='kw'>def</span> <span class='id identifier rubyid_unlink_tag_instances_from_wells'>unlink_tag_instances_from_wells</span><span class='lparen'>(</span><span class='id identifier rubyid_requests'>requests</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_requests'>requests</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_request'>request</span><span class='op'>|</span>
    <span class='id identifier rubyid_request'>request</span><span class='period'>.</span><span class='id identifier rubyid_asset'>asset</span><span class='period'>.</span><span class='id identifier rubyid_untag!'>untag!</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="validate_returned_tags_are_not_repeated_in_submission!-instance_method">
  
    #<strong>validate_returned_tags_are_not_repeated_in_submission!</strong>(requests, params)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


145
146
147
148
149
150
151
152
153
154</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/assign_tags_to_wells_task.rb', line 145</span>

<span class='kw'>def</span> <span class='id identifier rubyid_validate_returned_tags_are_not_repeated_in_submission!'>validate_returned_tags_are_not_repeated_in_submission!</span><span class='lparen'>(</span><span class='id identifier rubyid_requests'>requests</span><span class='comma'>,</span> <span class='id identifier rubyid_params'>params</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_submission_to_tag'>submission_to_tag</span> <span class='op'>=</span> <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:tag</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_well_id'>well_id</span><span class='comma'>,</span> <span class='id identifier rubyid_tag_id'>tag_id</span><span class='op'>|</span>
    <span class='id identifier rubyid_well_requests'>well_requests</span> <span class='op'>=</span> <span class='id identifier rubyid_requests'>requests</span><span class='period'>.</span><span class='id identifier rubyid_select'>select</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_request'>request</span><span class='op'>|</span> <span class='id identifier rubyid_request'>request</span><span class='period'>.</span><span class='id identifier rubyid_asset_id'>asset_id</span> <span class='op'>==</span> <span class='id identifier rubyid_well_id'>well_id</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span> <span class='rbrace'>}</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>couldnt find matching well request</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_well_requests'>well_requests</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span> <span class='op'>||</span> <span class='id identifier rubyid_well_requests'>well_requests</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
    <span class='lbracket'>[</span><span class='id identifier rubyid_well_requests'>well_requests</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span><span class='period'>.</span><span class='id identifier rubyid_submission_id'>submission_id</span><span class='comma'>,</span> <span class='id identifier rubyid_tag_id'>tag_id</span><span class='rbracket'>]</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Duplicate tags in single multiplex</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_submission_to_tag'>submission_to_tag</span> <span class='op'>!=</span> <span class='id identifier rubyid_submission_to_tag'>submission_to_tag</span><span class='period'>.</span><span class='id identifier rubyid_uniq'>uniq</span>

  <span class='kw'>nil</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="validate_tags_not_repeated_for_submission!-instance_method">
  
    #<strong>validate_tags_not_repeated_for_submission!</strong>(requests, tags_to_wells)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


180
181
182
183
184
185</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/assign_tags_to_wells_task.rb', line 180</span>

<span class='kw'>def</span> <span class='id identifier rubyid_validate_tags_not_repeated_for_submission!'>validate_tags_not_repeated_for_submission!</span><span class='lparen'>(</span><span class='id identifier rubyid_requests'>requests</span><span class='comma'>,</span> <span class='id identifier rubyid_tags_to_wells'>tags_to_wells</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_submission_to_tag'>submission_to_tag</span> <span class='op'>=</span> <span class='id identifier rubyid_requests'>requests</span><span class='period'>.</span><span class='id identifier rubyid_select'>select</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_request'>request</span><span class='op'>|</span> <span class='id identifier rubyid_request'>request</span><span class='period'>.</span><span class='id identifier rubyid_asset'>asset</span> <span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_request'>request</span><span class='op'>|</span> <span class='lbracket'>[</span><span class='id identifier rubyid_request'>request</span><span class='period'>.</span><span class='id identifier rubyid_submission_id'>submission_id</span><span class='comma'>,</span> <span class='id identifier rubyid_tags_to_wells'>tags_to_wells</span><span class='lbracket'>[</span><span class='id identifier rubyid_request'>request</span><span class='period'>.</span><span class='id identifier rubyid_asset'>asset</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='period'>.</span><span class='id identifier rubyid_description'>description</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_map_id'>map_id</span><span class='rbracket'>]</span> <span class='rbrace'>}</span>
  <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Duplicate tags will be assigned to a pooled tube</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_submission_to_tag'>submission_to_tag</span> <span class='op'>!=</span> <span class='id identifier rubyid_submission_to_tag'>submission_to_tag</span><span class='period'>.</span><span class='id identifier rubyid_uniq'>uniq</span>

  <span class='kw'>nil</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

      <div id="footer">
  Generated on Tue Oct 25 15:22:33 2016 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.5 (ruby-2.3.1).
</div>

    </div>
  </body>
</html>